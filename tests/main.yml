---
- hosts: localhost
  connection: local
  sudo: yes
  tasks:
    # Check service status for Mesos Master
    - name: Check mesos-master service
      shell: service mesos-master status | grep "running"
      register: master_service_status
      ignore_errors: yes

    - debug: msg=master_service_status.stdout
    - debug: msg={{master_service_status.stdout}}
    - debug: msg={{master_service_status}}
    - debug: msg={{master_service_status.rc}}
    - debug: msg={{master_service_status.stderr}}

    - fail: msg="mesos-master service is not running."
      when: master_service_status.stdout == ""

    # Check service status for Mesos Slave
    - name: Check mesos-slave service
      shell: service mesos-slave status | grep "running"
      register: slave_service_status
      ignore_errors: yes

    - fail: msg="mesos-slave service is not running."
      when: slave_service_status.stdout == ""
