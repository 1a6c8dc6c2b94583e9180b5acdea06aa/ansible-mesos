---
- hosts: localhost
  connection: local
  sudo: yes
  tasks:
    # Tests
    - name: Check mesos-master service
      shell: service mesos-master status
      register: master_service_status
      # ignore_errors: yes

    - debug: msg={{master_service_status.stderr}}
    - debug: msg={{master_service_status.stdout}}
    - debug: msg={{master_service_status.rc}}
    - debug: msg={{master_service_status.stdout_lines}}

    - fail: msg="mesos-master service is not running."
      when: master_service_status.stdout == ""

    - name: Check mesos-slave service
      shell: service mesos-slave status | grep "running"
      register: slave_service_status
      ignore_errors: yes
    - fail: msg="mesos-slave service is not running."
      when: slave_service_status.stdout == ""
